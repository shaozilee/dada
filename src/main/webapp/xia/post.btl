<!DOCTYPE html>
<html>
  <head>
    <title>Easy API Platform</title>
    <% include("_common.btl"){} %>
    <link rel="stylesheet" href="${ctxPath}/${theme}/css/index.css">
  </head>
  <body>
    <% include("_header.btl"){} %>
    <div class="container">

      <div class="top-box clearfix">
        <ul class="nav-box">
          <li>当前您在：</li>
          <li><a href="${ctxPath}/index.html">首页</a> <span class="divider">/</span></li>
          <li class="active">论坛</li>
        </ul>

        <ul class="count-box">
          <li style="border-right: none;">
            <div class="title">今日</div>
            <div class="num">1111</div>
          </li>
          <li>
            <div class="title">帖子</div>
            <div class="num">12312343</div>
          </li>
          <li>
            <div class="title">会员</div>
            <div class="num">13324</div>
          </li>


        </ul>

      </div>

      <div class="post-list">
        <div class="ctrl">
          <a class="btn new-btn" href="post/new.html?sid=${section.sid}" target="_blank">发新帖</a>
        </div>

        <div class="list-body">
          <% for(post in posts){%>
          <div class="row clearfix">
            <div class="col col1"><a href="post-${post.pid}.html" class="subject">${post.subject}</a></div>
            <div class="col col2"><a href="post-${post.pid}.html">${post.uid}</a><br>${post.dateline}</div>
            <div class="col col3">280<br>345</div>
            <div class="col col4">是发达是<br>12小时前</div>
          </div>
          <% }%>
        </div>
        <div class="page-bar">
          <a class='page pre ${pageHasPre?"":"disable"}' ${ pageHasPre?("href=section-"+section.sid+"-"+pagePre+".html"):""}>上一页</a>
          <% for(var i=start;i<=end;i++){%>
          <a class='page ${i == page?"active":""}' href="section-${section.sid}-${i}.html">${i}</a>
          <% }%>
          <a class='page next ${pageHasNext?"":"disable"}' ${ pageHasNext?("href=section-"+section.sid+"-"+pageNext+".html"):""}>下一页</a>
        </div>
      </div>


    </div>






    <div>
      this post uid: ${ post.uid }<br>
      this post sid: ${ post.sid }<br>
      this post id: ${ post.pid }<br>
      this post subject: ${ post.subject }<br>
      this post message: ${ post.message }<br>
      this post dateline: ${ post.dateline }<br>
      <a href="#reply-box" class="reply-btn">回复</a>
      <hr>

      <% for(comment in comments){ %>
        comment-rcid: ${ comment.rcid }<br>
        comment-cid: ${ comment.cid }<br>
        comment-uid: ${ comment.uid }<br>
        comment-message: ${ comment.message }<br>
        comment-dateline: ${ comment.dateline }<br>
        <a href="#reply-box" class="reply-btn" data-cid="${ comment.cid }">回复</a>
      <hr>
      <% }%>


      <div id="reply-box" style='display: ${ session.user != null?"block":"none"}'>
        <form id="commentForm" action="${ctxPath}/comment/add.do" method="post">
          <input type="hidden" name="pid" value="${ post.pid}">
          <input type="hidden" name="rcid">
          <input type="text" name="message"/>
          <input type="submit" title="回复">
        </form>
      </div>



    </div>

    <% include("_commonjs.btl"){} %>

    <script type="text/javascript">
      $(".reply-btn").click(function(){
        var cid = $(this).data("cid");
        if(cid){
          $("#commentForm>input[name='rcid']").val(cid);
        }else{
          $("#commentForm>input[name='rcid']").val("");
        }
      });


    </script>

  </body>
</html>
